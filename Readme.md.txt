📜 Project Arcana: The Three Hearts - Master Design Document (v6)1. 프로젝트 개요 (Overview)1.1 기본 정보프로젝트명: Arcana: The Three Hearts장르: 2D Top-down Pixel Art Action RPG (로그라이트 요소가 가미된 핵앤슬래시)타겟 플랫폼: Windows (Desktop) & Web (HTML5)엔진: Flutter + Flame + Bonfire (v3.x 이상)개발 목표: "모바일 게임의 가벼움"과 "PC 인디 게임의 타격감"을 동시에 잡는 하이브리드 경험 제공.1.2 핵심 가치 (Core Pillars)Tactile Combat (손맛): 모든 공격은 화면 흔들림, 파티클, 사운드, 역경직(Hit Stop)을 동반한다.Risk & Reward (위험과 보상): '3개의 심장'은 단순한 목숨이 아닌, 잃을수록 강해지거나(광전사 모드) 약해지는 전략적 자원이다.Seamless Experience (끊김 없음): 로딩 없는 맵 전환, 즉각적인 UI 반응, 부드러운 애니메이션.2. 세계관 및 스토리 (Lore & Narrative)2.1 배경: 아르카나(Arcana) 대륙고대 마법 문명이 멸망한 후, 세 개의 심장(신체, 정신, 영혼)을 가진 신인류 '트리니티'가 지배하는 세상.주인공은 심장을 하나씩 잃을 때마다 인간성을 상실하지만, 대신 금지된 '공허의 힘'을 얻게 된다.2.2 챕터 구성Chapter 1: 잊혀진 숲 (The Forgotten Forest)테마: 자연, 독(Poison), 덩굴.보스: 오염된 세계수 '이그드라'.Chapter 2: 심연의 동굴 (Abyssal Cave)테마: 어둠, 크리스탈, 마법.보스: 수정 골렘 '오닉스'.Chapter 3: 붉은 요새 (Crimson Fortress)테마: 불, 강철, 기계.보스: 폭군 '카이저'.3. 상세 기술 명세 (Technical Specifications)3.1 기술 스택 & 버전Framework: Flutter SDK 3.19.0 이상 (Dart 3.3+)Game Engine: bonfire: ^3.0.0 (필수), flame: ^1.16.0Audio: flame_audio (BGM: .ogg / SFX: .wav)State Management: flutter_riverpod (코드 생성기 riverpod_generator 사용 권장)Backend: Firebase (Auth, Firestore, Remote Config, Hosting)Local Storage: shared_preferences (설정 저장), hive (게임 데이터 캐싱 - 옵션)3.2 프로젝트 구조 (Directory Structure)lib/
├── main.dart                  # 앱 진입점 (Firebase Init, DI 설정)
├── config/                    # 테마, 상수, 라우터
│   ├── assets.dart            # 이미지/오디오 경로 상수화
│   └── constants.dart         # 물리 상수 (중력, 속도 등)
├── data/                      # 데이터 레이어
│   ├── model/                 # 데이터 모델 (JsonSerializable)
│   ├── repository/            # 데이터 저장소 (Local/Remote 분기 처리)
│   └── service/               # Firebase, Auth 서비스
├── game/                      # 게임 로직 (Bonfire/Flame)
│   ├── behaviors/             # 적 AI, 투사체 로직
│   ├── characters/            # Player, Enemy 클래스
│   ├── decorations/           # 맵 오브젝트 (상자, 함정)
│   ├── interface/             # 인게임 HUD (체력바, 미니맵)
│   └── maps/                  # 타일맵 로더
├── providers/                 # Riverpod 상태 관리자
└── ui/                        # Flutter 위젯 (메인 메뉴, 설정, 인벤토리)
    ├── components/            # 공용 버튼, 다이얼로그
    └── screens/               # 화면 단위 위젯
4. 게임 메카닉 상세 (Deep Mechanics)4.1 전투 공식 (Combat Formulas)데미지 계산: Damage = (Attacker.ATK * Random(0.9, 1.1)) - (Defender.DEF * 0.5)최소 데미지: 1은 무조건 들어감.크리티컬: 기본 1.5배 데미지 (화면 줌인 효과 동반).속성 상성:🔥 불 > 🌿 풀 (1.5배 데미지 + 화상 상태이상)🌿 풀 > 💧 물 (1.5배 데미지 + 속박)💧 물 > 🔥 불 (1.5배 데미지 + 공격력 감소)4.2 하트 시스템 (The Three Hearts)Heart 1 (Body): 깨지면 이동 속도 10% 감소, 방어력 20% 감소.Heart 2 (Mind): 깨지면 시야(화면 밝기) 감소, 스킬 쿨타임 증가.Heart 3 (Soul): 깨지면 사망 (Game Over).기획 의도: 체력이 깎일수록 게임이 더 공포스럽고 어렵게 변함.5. 데이터베이스 스키마 (DB Schema)5.1 Firestore Collectionsusers/{uid}profile: { nickname: string, avatarId: int, createdAt: timestamp }stats: { level: int, exp: int, gold: int, maxStage: int }equipment: [{ id: string, type: "weapon|armor", enhanceLevel: int }]settings: { bgmVolume: double, sfxVolume: double, language: string }leaderboard/{seasonId}rankings: [{ uid: string, nickname: string, score: int, recordedAt: timestamp }]전략: 문서를 하나에 몰아넣지 않고, 상위 100위까지만 별도 문서로 관리하거나 샤딩(Sharding) 고려.6. 아트 & 오디오 규격 (Art & Audio Specs)6.1 Pixel Art GuidelinesGrid Size: 기본 타일 16x16 또는 32x32.Scale: 게임 내 줌 레벨 2.0x ~ 3.0x 고정.Color Palette: 'Arcana Retro' (자체 정의 32색 팔레트 사용 권장).Format: .png (투명 배경), 스프라이트 시트 사용.6.2 Audio GuidelinesBGM: .ogg (루프 포인트 메타데이터 포함 권장), 128kbps 이상.SFX: .wav (무압축) 또는 .mp3 (짧은 효과음).Channels: BGM, SFX, UI, Voice 4개 채널 믹싱.7. 상세 개발 마일스톤 (Expanded Roadmap)🥚 Phase 0: The Setup (1주차)[ ] Flutter 프로젝트 생성 및 린트(Lint) 규칙 설정 (flutter_lints).[ ] GitHub Repository 생성 및 브랜치 보호 규칙(Main Branch Protection) 설정.[ ] Firebase 프로젝트 생성 (Dev/Prod 환경 분리 권장).[ ] assets 폴더 구조 잡기 및 폰트(DungGeunMo 등 픽셀 폰트) 적용.🐣 Phase 1: Prototype (2~3주차)[ ] Bonfire Joystick 및 Player 기본 이동 구현.[ ] 타일맵 에디터(Tiled)로 10x10 기본 룸 제작 및 로드.[ ] "허수아비" 적 구현: 때리면 흔들리고 데미지 숫자 뜨는 기능.[ ] 핵심 검증: 공격 버튼을 눌렀을 때의 딜레이가 0.1초 미만이어야 함.🐥 Phase 2: Core Loop (4~6주차)[ ] 적 AI (State Machine): 배회(Idle) -> 추적(Chase) -> 공격(Attack).[ ] 던전 생성 알고리즘: 미리 만들어진 방(Prefab)들을 랜덤하게 연결.[ ] 인벤토리 시스템: 아이템 획득 시 UI에 실시간 반영 (Riverpod 활용).[ ] 게임 오버 및 재시작 프로세스 구현.🦅 Phase 3: Content & Polish (7~10주차)[ ] 챕터 1 몬스터 3종, 보스 1종 픽셀 아트 및 패턴 구현.[ ] 사운드 매니저 연동 (타격음, 피격음, 발자국 소리).[ ] VFX: 파티클 시스템 (ParticleSystemComponent)을 이용한 혈흔, 먼지 효과.[ ] 쉐이더(Shader) 적용: 피격 시 하얗게 깜빡이는 효과 (Flash Effect).🚀 Phase 4: Backend & Deploy (11~12주차)[ ] 익명 로그인 및 데이터 클라우드 동기화 로직.[ ] 랭킹 페이지 UI 제작 및 실시간 데이터 바인딩.[ ] CI/CD: GitHub Actions 스크립트 작성 (flutter build web --release).[ ] Firebase Hosting 배포 및 Windows Installer 패키징.8. 개발자 가이드라인 (Developer Rules)8.1 코드 컨벤션 (Coding Standards)Strict Typing: dynamic 타입 사용을 엄격히 금지한다. 데이터 구조를 모를 땐 Map<String, dynamic> 대신 명확한 모델 클래스를 정의한다.Early Return: if-else 중첩을 피하고, 조건이 맞지 않으면 빠르게 리턴한다.Comments: 모든 public 함수와 복잡한 알고리즘(데미지 계산 등)에는 반드시 한글 주석을 단다.8.2 리소스 관리 (Resource Management)Preload: 게임 시작 시 Flame.images.loadAll(['player.png', 'enemy.png'])로 필수 에셋을 메모리에 올린다.Dispose: 화면 전환 시 onRemove()에서 사용하지 않는 컨트롤러나 리스너를 반드시 해제한다.8.3 Git 전략 (Git Strategy)main: 언제든 배포 가능한 안정 버전.develop: 개발 중인 최신 버전.feat/기능명: 새로운 기능 개발 (예: feat/inventory-ui).PR Rule: PR은 반드시 "Self-Check" 리스트를 체크한 후 머지한다. (빌드 성공 여부, 린트 에러 여부 확인)